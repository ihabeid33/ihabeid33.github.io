---
layout: post
title: File Storage with TrueNAS
date: 2024-10-09 14:26:00.000000000 -04:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Storage
tags: []
image: 
  path: assets/2024/10/truenas_logo.png
  width: 1200
  height: 630
meta:
  _g_feedback_shortcode_cd0e476797c31d70c5f404a6379398052b288b19: "\n\t\t\t\t[contact-field
    label=\"Name\" type=\"name\"  required=\"true\" /]\n\t\t\t\t[contact-field label=\"Email\"
    type=\"email\" required=\"true\" /]\n\t\t\t\t[contact-field label=\"Website\"
    type=\"url\" /]\n\t\t\t\t[contact-field label=\"Message\" type=\"textarea\" /]"
  _g_feedback_shortcode_atts_cd0e476797c31d70c5f404a6379398052b288b19: a:18:{s:2:"to";s:20:"ihabeid33@icloud.com";s:7:"subject";s:36:"[1h4b
    31d] File Storage with TrueNAS";s:12:"show_subject";s:2:"no";s:6:"widget";i:0;s:14:"block_template";N;s:19:"block_template_part";N;s:2:"id";i:433;s:18:"submit_button_text";s:6:"Submit";s:14:"customThankyou";s:0:"";s:21:"customThankyouHeading";s:26:"Your
    message has been sent";s:21:"customThankyouMessage";s:30:"Thank you for your submission!";s:22:"customThankyouRedirect";s:0:"";s:10:"jetpackCRM";b:1;s:9:"className";N;s:9:"postToUrl";N;s:14:"salesforceData";N;s:12:"hiddenFields";N;s:14:"stepTransition";s:10:"fade-slide";}
  _edit_last: '1'
  bloglo_disable_topbar: ''
  bloglo_disable_header: ''
  bloglo_disable_page_title: ''
  bloglo_disable_breadcrumbs: ''
  bloglo_disable_thumbnail: ''
  bloglo_disable_footer: ''
  bloglo_disable_copyright: ''
  bloglo_disable_blog_card_border: ''
  _thumbnail_id: '472'
  _wp_old_date: '2025-07-03'
permalink: "/2024/10/09/file-storage-with-truenas/"
---
<p></p>
<h2 class="wp-block-heading">TrueNAS Scale</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>There are times that we find ourselves needing a place to store our ever-expanding collection of files, and the simple 1TB hard drive on our workstation just won't cut it anymore. In such cases, we should probably set up a NAS. A <strong>NAS</strong>, or "Network Attached Storage", is a device that is connected to a network and acts as a dedicated file storage service. Users on the network can connect to it via a 'file share' and be able to access, share, or copy their files with other users. NAS's do this job by pooling a large amount of hard drives together in what is called a 'redundant disk array'. These disk array (or <strong>RAID</strong>) configurations allow a network to centralize hundreds of terabytes of storage while also providing redundancy in case a disk fails. Without redundancy, all of the data could be lost if a single hard drive stops working. This is because the data is "striped" across each disk in the pool.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>There are multiple ways you can set up a NAS in your organization's network or your own homelab. You could purchase a pre-built, ready-to-go device like a Synology NAS. Many hypervisors these days can function as a NAS at some level. For example, Proxmox is an open-source and Linux-based hypervisor that is able to pool together multiple disks into a RAID configuration using a file system technology called 'ZFS'. The inverse is also true. Dedicated NAS solutions can also have the ability to host virtual machines and containers. A great example is TrueNAS. TrueNAS is a family of open-source NAS solutions developed by iXsystems. Its variations include TrueNAS Core (Unix-based), TrueNAS Community Edition (Linux-based), and TrueNAS Enterprise (business version of the Community Edition and not free).</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>I initially decided to set up a NAS because I needed a larger file storage for my media server running Jellyfin and Audiobookshelf. Jellyfin is an application that manages and streams my movies and TV shows for me, and Audiobookshelf streams my audiobooks. As my media collection grew, I quickly realized the SSD on my media server was going to run out of space. Therefore, in order to add storage to my homelab, I decided to set up TrueNAS Community Edition (formally known as TrueNAS Scale).</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Hardware</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>To install TrueNAS on bare metal, you need a desktop or server that can carry at least three hard drives. One of the disks is for the boot-drive so it only must be at least 32 GB in size.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p><em>Disclaimer: Try not to use a large capacity drive for the boot because you will not be able to use the remaining space for anything other than booting TrueNAS. </em></p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Pretty much any not-so-old i5, i7 or Xeon with 5-6 cores will suffice for processing power. RAM will be more important than the CPU anyways. It is the general consensus that you should ideally have 1 gigabyte of RAM for every terabyte of storage in your NAS. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>For my NAS build, I used an old HP ProDesk 600 that rocks a humble 4th Gen i5 4-core CPU and 16 GB of DDR3 memory. As for my storage, I managed to stuff 2x8 GB HDDs (plus an SSD for the boot drive) inside of it. So far, I think this was enough to do the job, but I can always upgrade if I need to.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Installation</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Installation is fairly simple after burning the ISO to a usb stick and booting into it:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list {"ordered":true} --></p>
<ol class="wp-block-list">
<!-- wp:list-item --></p>
<li>Enter the Installation Wizard.</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Select the drive you want TrueNAS to boot from, and confirm.</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Enter and confirm a password for the admin user.</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Reboot.</li>
<p><!-- /wp:list-item -->
</ol>
<p><!-- /wp:list --></p>
<p><!-- wp:paragraph --></p>
<p>After those simple steps, you should be able to log into the Web UI and begin using TrueNAS.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:jetpack/slideshow {"ids":[444,442,445,441,443,446],"sizeSlug":"full"} --></p>
<div class="wp-block-jetpack-slideshow aligncenter" data-effect="slide" style="--aspect-ratio:calc(2560 / 1183)">
<div class="wp-block-jetpack-slideshow_container swiper-container">
<ul class="wp-block-jetpack-slideshow_swiper-wrapper swiper-wrapper">
<li class="wp-block-jetpack-slideshow_slide swiper-slide">
<figure><img alt="" class="wp-block-jetpack-slideshow_image wp-image-444" data-id="444" data-aspect-ratio="2560 / 1183" src="{{site.baseurl}}/assets/2024/10/20250702_012440-scaled.jpg"><br />
<figcaption class="wp-block-jetpack-slideshow_caption gallery-caption">Enter Wizard</figcaption>
</figure>
</li>
<li class="wp-block-jetpack-slideshow_slide swiper-slide">
<figure><img alt="" class="wp-block-jetpack-slideshow_image wp-image-442" data-id="442" data-aspect-ratio="2560 / 1183" src="{{site.baseurl}}/assets/2024/10/20250702_012450-scaled.jpg"><br />
<figcaption class="wp-block-jetpack-slideshow_caption gallery-caption">Select Boot Drive</figcaption>
</figure>
</li>
<li class="wp-block-jetpack-slideshow_slide swiper-slide">
<figure><img alt="" class="wp-block-jetpack-slideshow_image wp-image-445" data-id="445" data-aspect-ratio="2560 / 1183" src="{{site.baseurl}}/assets/2024/10/20250702_012502-scaled.jpg"><br />
<figcaption class="wp-block-jetpack-slideshow_caption gallery-caption">Confirm you Understand</figcaption>
</figure>
</li>
<li class="wp-block-jetpack-slideshow_slide swiper-slide">
<figure><img alt="" class="wp-block-jetpack-slideshow_image wp-image-441" data-id="441" data-aspect-ratio="2560 / 1183" src="{{site.baseurl}}/assets/2024/10/20250702_012519-scaled.jpg"><br />
<figcaption class="wp-block-jetpack-slideshow_caption gallery-caption">Select 1st Option and Choose a Password</figcaption>
</figure>
</li>
<li class="wp-block-jetpack-slideshow_slide swiper-slide">
<figure><img alt="" class="wp-block-jetpack-slideshow_image wp-image-443" data-id="443" data-aspect-ratio="2560 / 1183" src="{{site.baseurl}}/assets/2024/10/20250702_012741-scaled.jpg"><br />
<figcaption class="wp-block-jetpack-slideshow_caption gallery-caption">Done.</figcaption>
</figure>
</li>
<li class="wp-block-jetpack-slideshow_slide swiper-slide">
<figure><img alt="" class="wp-block-jetpack-slideshow_image wp-image-446" data-id="446" data-aspect-ratio="2560 / 1183" src="{{site.baseurl}}/assets/2024/10/20250702_012757-scaled.jpg"><br />
<figcaption class="wp-block-jetpack-slideshow_caption gallery-caption">Reboot.</figcaption>
</figure>
</li>
</ul>
<p><a class="wp-block-jetpack-slideshow_button-prev swiper-button-prev swiper-button-white" role="button"></a><a class="wp-block-jetpack-slideshow_button-next swiper-button-next swiper-button-white" role="button"></a><a aria-label="Pause Slideshow" class="wp-block-jetpack-slideshow_button-pause" role="button"></a>
<div class="wp-block-jetpack-slideshow_pagination swiper-pagination swiper-pagination-white"></div>
</div>
</div>
<p><!-- /wp:jetpack/slideshow --></p>
<p><!-- wp:paragraph --></p>
<p>Although if you're a beginner like I am, there are some caveats and simple mistakes you should watch out for.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list --></p>
<ul class="wp-block-list">
<!-- wp:list-item --></p>
<li>Make sure you take out the USB stick after it's done installing. If you don't, it will boot into it again.</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Make sure the boot order is correct. It should be something like:<!-- wp:list -->
<ul class="wp-block-list">
<!-- wp:list-item --></p>
<li>USB &gt; Boot-Drive &gt; Any_Other_Drive_For_Storage</li>
<p><!-- /wp:list-item -->
</ul>
<p><!-- /wp:list -->
</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Make sure your ethernet cables are plugged in. (Duh)</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Make sure you have DCHP working on that subnet or VLAN. (or just assign one statically)<!-- wp:list -->
<ul class="wp-block-list">
<!-- wp:list-item --></p>
<li>Your TrueNAS can't start the Web UI if it doesn't have an IP address.</li>
<p><!-- /wp:list-item -->
</ul>
<p><!-- /wp:list -->
</li>
<p><!-- /wp:list-item -->
</ul>
<p><!-- /wp:list --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Setup and Pool Creation</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>After logging in, you will be greeted with the <strong>Dashboard</strong>. At this point you should be able to make any tweaks you need to your NAS's settings. For example, I changed the domain, hostname, and nameserver.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":451,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{site.baseurl}}/assets/2024/10/00_dashboard-1-1024x548.png" alt="" class="wp-image-451"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>To be able to utilize our storage, we need to first create a "pool". To do that, first make sure TrueNAS is aware of your disks by going to the '<strong>Storage Dashboard</strong>', then clicking '<strong>Disks</strong>'. Your boot drive will be designated as "boot-pool".</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":452,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{site.baseurl}}/assets/2024/10/05_disks-1024x543.png" alt="" class="wp-image-452"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>After confirming the disks are available, you can start creating your pool by going back to the <strong>Storage Dashboard</strong> and clicking '<strong>Create Pool</strong>'. This will start the <strong>Pool Creation Wizard</strong>.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":453,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{site.baseurl}}/assets/2024/10/04_create_pool-1024x545.png" alt="" class="wp-image-453"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>First Step: Name your pool and choose if you want to enable encryption.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":454,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{site.baseurl}}/assets/2024/10/06_namepool-1024x582.png" alt="" class="wp-image-454"><br />
<figcaption class="wp-element-caption">Naming Pool</figcaption>
</figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>Step 2 is to choose your disk layout. You have many different options. </p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The <strong>worst</strong> option is to stripe all your data across all your disks. You do not want to do this as you will not have any disk redundancy. This means that if one of your disks fails, you will have no way to recover your data. The only plus side is that you will be able to use every last bit of your storage space.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>The better options are one of the RAID schemes. These allow you to have a varied balance between being able to use most of your storage space and still having redundancy. The downside is that you need to have at least three disks for RAIDZ1, at least four for RAIDZ2, and at least five disks for RAIDZ3.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Unfortunately for me, I only had two 8TB hard drives in my NAS, leaving me with only the 'Mirror' option. This option uses one disk for storage and mirrors the data to the other drive for redundancy. Only being able to use 50% of my storage space isn't ideal, but my machine doesn't fit any more drives and it's better than risking data loss.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":456,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{site.baseurl}}/assets/2024/10/07_choose_disks-1-1024x487.png" alt="" class="wp-image-456"><br />
<figcaption class="wp-element-caption">Layout</figcaption>
</figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>There are several more optional steps that require extra drives. I did not utilize these because they require more drives. Here is a brief explanation of each:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:list --></p>
<ul class="wp-block-list">
<!-- wp:list-item --></p>
<li>Log: ZFS log device to improve write speeds.</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Spare: Drive reserved for automatically replacing a failed drive.</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Cache: A read-cache to improve read performance.</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Metadata: Speeds up metadata Input/Output.</li>
<p><!-- /wp:list-item --></p>
<p><!-- wp:list-item --></p>
<li>Dedup: Deduplication tables are basically a lookup mechanism that improve performance for certain things.</li>
<p><!-- /wp:list-item -->
</ul>
<p><!-- /wp:list --></p>
<p><!-- wp:paragraph --></p>
<p>Review your configuration and if you're happy, click '<strong>Create Pool</strong>'. Your Storage Dashboard should look similar to this when it's done:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":457,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{site.baseurl}}/assets/2024/10/08_pool_done-1024x539.png" alt="" class="wp-image-457"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>The next step is to create datasets to organize and store your files.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Creating Datasets</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>A dataset is sort of like a file system. You create different datasets for different things, such as one dataset for media files and another for docker containers. Datasets can also have parent-child relationships, so you can have datasets within datasets.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":459,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{site.baseurl}}/assets/2024/10/09_datasets-1024x561.png" alt="" class="wp-image-459"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>To create a dataset, go to your Dataset Dashboard, select your pool, and click '<strong>Add Dataset</strong>'.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>From there, name your dataset whatever you like, and then select a preset. If you plan to set up an SMB share with this dataset, select <strong>SMB</strong>. If it's going to be for containers, select <strong>App</strong>. If you're like me and you're setting up an NFS share, select <strong>Generic</strong>. You can leave the advanced options as default for now and click save.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":460,"sizeSlug":"full","linkDestination":"none"} --></p>
<figure class="wp-block-image size-full"><img src="{{site.baseurl}}/assets/2024/10/10_dataset_options.png" alt="" class="wp-image-460"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>Make sure you re-select the pool for every dataset you create if you want it to be the parent. You might accidentally set the parent of any new dataset you create as the previously created dataset.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":462,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{site.baseurl}}/assets/2024/10/11_datasets_created-1024x571.png" alt="" class="wp-image-462"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Dataset Permissions</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>After creating a dataset, it's important to configure its permissions appropriately. Permissions control how users, and groups of users, are allowed to interact with resources. TrueNAS provides two main ways to fine-tuning the permissions applied to datasets: <strong>Unix Permissions</strong> and <strong>Access Control Lists</strong> (ACLs).</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":4} --></p>
<h4 class="wp-block-heading">Unix Permissions</h4>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Unix permissions are the most basic way to do access control on a dataset. These permissions function on two main axes: ownership and access. Files and directories are set to be owned by both a user and a group. If a user does not fit into either that user or group ownership, it will be classified as 'other'. For each of those three types of ownership, there are also three types access controls: read, write, and execute (rwx). Combining both ownership and access controls gives us a matrix of 3x3, as you can see on your dataset's permissions editor.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>To edit a dataset's permissions, select the dataset to edit, find the "Permissions" box, and click 'Edit'. This will open the Unix Permissions Editor.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":479,"sizeSlug":"full","linkDestination":"none"} --></p>
<figure class="wp-block-image size-full"><img src="{{site.baseurl}}/assets/2024/10/15_unix_permissions.png" alt="" class="wp-image-479"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>I found that balancing the accessibility needs of my dataset, while also keeping it secure, was kind of tricky at first. I needed the service accounts on a different machine (media server) to be able to access the file share, but I did not want to grant users in the 'Other' group access to it for security purposes. A simple solution that worked for me was to create a new group called 'media' and grant it ownership to the dataset. The downside to this is that I also had to recreate the same group on any machine that needs access, then add the necessary users and service accounts to that group.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Unix permissions are traditional and the simpler way of controlling access. They are more suited for smaller Unix/Linux environments that do not need complex user or group access rights. Unix permissions are also mostly used with NFS shares instead of SMB.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":4} --></p>
<h4 class="wp-block-heading">Access Control Lists</h4>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>ACLs are typically set up when sharing over SMB, and sharing to more complex environments that use both Windows and Linux operating systems. They use a more complex, Windows style permission scheme with attributes like Read, Read/Write, Full Access, or Deny being applied to users and groups. The screenshot below shows how I set up a different dataset's permissions that is being shared over SMB:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":480,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{site.baseurl}}/assets/2024/10/16_acl-1024x719.png" alt="" class="wp-image-480"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Adding Shares</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>In order to share our datasets to a network, we need to add a file sharing service. TrueNAS gives us three options: NFS, SMB, and iSCSI.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":463,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{site.baseurl}}/assets/2024/10/12_shares-1024x511.png" alt="" class="wp-image-463"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 class="wp-block-heading">NFS</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>This is the Network File System. It is a Unix-based file share, great for Linux and UNIX environments.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 class="wp-block-heading">SMB</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Server Message Block. A Windows-based file share commonly used in Windows and Active Directory environments, although Linux machines do have the ability to mount an SMB drive.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 class="wp-block-heading">iSCSI</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Internet Small Computer Systems Interface. This is another network protocol that shares storage devices over IP. It works by encapsulating SCSI commands within network packets.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:heading {"level":3} --></p>
<h3 class="wp-block-heading">Sharing with NFS</h3>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>I chose to use NFS to share my datasets. To add an NFS share, first go to the <strong>Shares</strong> menu, and click the '<strong>Add</strong>' button within the NFS box. Next, select the path to the dataset you want to share and make sure the '<strong>Enabled</strong>' option is checked. All other options can be left as the default. Click '<strong>Save</strong>' to launch it.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":464,"sizeSlug":"large","linkDestination":"none"} --></p>
<figure class="wp-block-image size-large"><img src="{{site.baseurl}}/assets/2024/10/13_share_options-1024x585.png" alt="" class="wp-image-464"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:paragraph --></p>
<p>Now your NFS service should be running and sharing your dataset.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":466,"sizeSlug":"full","linkDestination":"none"} --></p>
<figure class="wp-block-image size-full"><img src="{{site.baseurl}}/assets/2024/10/14_shares_up.png" alt="" class="wp-image-466"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:heading {"level":4} --></p>
<h4 class="wp-block-heading">File Share Permissions</h4>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>File shares have their own network-based access controls, besides the permissions on datasets mentioned before. File share access controls allow you to specify which networks, hosts, or IP addresses are authorized to access the file share. Restricting access based on network or IP addresses allow for a more granular way to apply permissions securely, without being to restrictive with traditional Unix permissions or ACLs.</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:image {"id":481,"sizeSlug":"full","linkDestination":"none"} --></p>
<figure class="wp-block-image size-full"><img src="{{site.baseurl}}/assets/2024/10/17_network_access.png" alt="" class="wp-image-481"></figure>
<p><!-- /wp:image --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">Mounting NFS</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Finally, we get to mount the NFS drives we created, which can be done with a simple command:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>sudo mount -t nfs [ip_of_truenas]:/mount/point/to/share [local mount directory]</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:paragraph --></p>
<p>Example:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>sudo mount -t nfs 10.1.3.5:/mnt/pool0/books /tmp/share/books/</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:heading --></p>
<h2 class="wp-block-heading">fstab</h2>
<p><!-- /wp:heading --></p>
<p><!-- wp:paragraph --></p>
<p>Maybe you want your system to mount a share at boot. On Linux, you just have to edit a single file:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>/etc/fstab</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:paragraph --></p>
<p>Here's my media server's fstab file as an example:</p>
<p><!-- /wp:paragraph --></p>
<p><!-- wp:code --></p>
<pre class="wp-block-code"><code>10.1.1.19:/mnt/pool0/jellyfin /share/jellyfin nfs rw,vers=4.0 0 0

10.1.1.19:/mnt/pool0/books /share/books nfs rw,vers=4.0 0 0</code></pre>
<p><!-- /wp:code --></p>
<p><!-- wp:paragraph --></p>
<p>The parameters you add will depend on your situation (like the NFS version running on TrueNAS).</p>
<p><!-- /wp:paragraph --><br />
</body></html></p>
